<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Potenzen- & Zehnerpotenzen-Trainer</title>
<style>
  html, body { height: 100%; overflow-x: hidden; }
  body {
    font-family: system-ui, Arial, sans-serif;
    background: linear-gradient(to bottom right,#f0f4ff,#e0f7fa);
    text-align: center;
    margin: 0; padding: 20px;
  }
  h1, h2 { color:#333; margin:10px 0; font-size:1.6em; font-weight:600; }
  #task, #taskAdd { font-size:1.8em; margin:15px auto; display:block; word-wrap:break-word; }
  #eqMark { font-size:1em; margin-left:6px; color:#333; }
  #result,#resultAdd { font-size:1.3em; margin:10px; font-weight:bold; }
  #score,#scoreAdd { font-size:1.1em; margin:8px; color:#333; }
  input {
    padding:10px; font-size:1.2em; width:80%; max-width:300px;
    text-align:center; border-radius:8px; border:1px solid #aaa;
  }
  input:focus { outline:none; border-color:#007bff; }
  button {
    background:#007bff; color:white; border:none;
    padding:10px 18px; margin:6px; font-size:1em;
    border-radius:8px; cursor:pointer;
  }
  button:hover { background:#0056b3; }
  .supButtons { margin-top:8px; }
  .supButtons button {
    background:#e3e3e3; color:#000; border:1px solid #bbb;
    padding:6px 10px; margin:2px; font-size:1.1em;
  }
  .supButtons button:hover { background:#ccc; }
  hr { margin:30px auto; width:70%; border:1px solid #ccc; }
</style>
</head>
<body>

<h1>Potenzen ‚Äì Multiplikation, Division, Potenzieren</h1>
<div id="score">Aufgabe 1 von 10 ‚Äì Punkte: 0</div>
<div id="task">lade...</div>

<input type="text" id="answer" placeholder="Deine L√∂sung" autocomplete="off" spellcheck="false"><br>
<div class="supButtons" id="supBtns1"></div>

<button id="checkBtn">Pr√ºfen</button>
<button id="newBtn">Neue Aufgabe</button>
<p id="result"></p>

<hr>

<h2>Zehnerpotenzen & Gleitkommazahlen</h2>
<div id="scoreAdd">Aufgabe 1 von 10 ‚Äì Punkte: 0</div>
<div>
  <span id="taskAdd">lade...</span><span id="eqMark"> = ?</span>
</div>

<input type="text" id="answerAdd" placeholder="Deine L√∂sung" autocomplete="off" spellcheck="false"><br>
<div class="supButtons" id="supBtns2"></div>

<button id="checkBtnAdd">Pr√ºfen</button>
<button id="newBtnAdd">Neue Aufgabe</button>
<p id="resultAdd"></p>

<p style="font-size:0.8em;color:#555;margin-top:40px;">
Diese Seite speichert keine pers√∂nlichen Daten und l√§uft vollst√§ndig lokal im Browser.<br>
¬© 2025 Potenztrainer f√ºr den Mathematikunterricht
</p>

<script>
document.addEventListener("DOMContentLoaded",()=>{

  // ===== Hilfsfunktionen =====
  const VARS = ['a','b','x','y'];
  const randomChoice = a => a[Math.floor(Math.random()*a.length)];
  const randInt = (min,max)=>Math.floor(Math.random()*(max-min+1))+min;
  const superExp={1:"¬π",2:"¬≤",3:"¬≥",4:"‚Å¥",5:"‚Åµ",6:"‚Å∂",7:"‚Å∑",8:"‚Å∏",9:"‚Åπ"};
  const expToSup=e=>superExp[e]||"";

  function normExp(str){
    // Standardisierung: Leerzeichen und Sonderzeichen raus
    let s = str
      .replace(/\s+/g,"")
      .replace(/¬∑/g,"*")
      .replace(/:/g,"/")
      .toLowerCase();

    // a¬π soll als a erkannt werden
    s = s.replace(/([a-z])¬π/g,"$1");

    // x‚Å∞ soll als 1 erkannt werden
    s = s.replace(/[a-z]‚Å∞/g,"1");

    return s;
  }

  function makeSupButtons(containerId, inputEl) {
    const cont = document.getElementById(containerId);
    for (let i=1; i<=9; i++){
      const btn = document.createElement("button");
      btn.textContent = superExp[i];
      btn.type="button";
      btn.onclick = ()=>insertSymbol(inputEl, superExp[i]);
      cont.appendChild(btn);
    }
  }

  function insertSymbol(target, symbol){
    const start = target.selectionStart ?? target.value.length;
    const end = target.selectionEnd ?? target.value.length;
    const text = target.value;
    target.value = text.slice(0, start) + symbol + text.slice(end);
    const pos = start + symbol.length;
    requestAnimationFrame(()=>{
      target.focus();
      target.selectionStart = target.selectionEnd = pos;
    });
  }

  // ===== Teil 1: Potenzen mit gleicher Basis =====
  const taskEl=document.getElementById("task");
  const answerEl=document.getElementById("answer");
  const checkBtn=document.getElementById("checkBtn");
  const newBtn=document.getElementById("newBtn");
  const resultEl=document.getElementById("result");
  const scoreEl=document.getElementById("score");
  makeSupButtons("supBtns1", answerEl);

  let correctSolution="";
  let round=1,score=0,totalRounds=10;

  // Exponenten sollen <= 9 bleiben
  function createPowMultiply(){
    const base=randomChoice(VARS);
    const e1=randInt(1,5);
    const e2=randInt(1,5);
    const result=e1+e2;
    if(result>9) return createPowMultiply(); // falls zu gro√ü, neu generieren
    correctSolution=`${base}${expToSup(result)}`;
    return `${base}${expToSup(e1)} ¬∑ ${base}${expToSup(e2)} = ?`;
  }

  function createPowDivide(){
    const base=randomChoice(VARS);
    const e1=randInt(2,9);
    const e2=randInt(1,e1-1);
    const result=e1-e2;
    if(result>9) return createPowDivide();
    correctSolution = result === 0 ? "1" : `${base}${expToSup(result)}`;
    return `${base}${expToSup(e1)} : ${base}${expToSup(e2)} = ?`;
  }

  function createPowOfPow(){
    const base=randomChoice(VARS);
    const e1=randInt(1,4);
    const e2=randInt(2,3);
    const result=e1*e2;
    if(result>9) return createPowOfPow();
    correctSolution=`${base}${expToSup(result)}`;
    return `(${base}${expToSup(e1)})${expToSup(e2)} = ?`;
  }

  function newTask(){
    resultEl.innerText="";answerEl.value="";
    if(round>totalRounds){
      taskEl.innerText="üéâ √úbungsrunde fertig!";
      resultEl.style.color="green";
      resultEl.innerText=`Endstand: ${score}/${totalRounds} Punkte.`;
      newBtn.textContent="Neue Runde"; round=1; score=0; return;
    }
    const r=Math.random();
    let aufgabe;
    if(r<0.4)aufgabe=createPowMultiply();
    else if(r<0.8)aufgabe=createPowDivide();
    else aufgabe=createPowOfPow();
    taskEl.innerText=aufgabe;
    scoreEl.innerText=`Aufgabe ${round} von ${totalRounds} ‚Äì Punkte: ${score}`;
  }

  function checkAnswer(){
    const input=answerEl.value.trim();
    if(!input){resultEl.style.color="gray";resultEl.innerText="Bitte gib eine L√∂sung ein.";return;}
    if(normExp(input)===normExp(correctSolution)){
      resultEl.style.color="green";resultEl.innerText="‚úÖ Richtig!";score++;
    }else{
      resultEl.style.color="red";resultEl.innerText=`‚ùå Falsch! Richtig: ${correctSolution}`;
    }
    round++;
    scoreEl.innerText=`Aufgabe ${Math.min(round,totalRounds)} von ${totalRounds} ‚Äì Punkte: ${score}`;
  }

  checkBtn.addEventListener("click",checkAnswer);
  newBtn.addEventListener("click",newTask);
  answerEl.addEventListener("keydown",e=>{if(e.key==="Enter")checkAnswer();});
  newTask();


  // ===== Teil 2: Zehnerpotenzen & Gleitkomma =====
  const taskAdd=document.getElementById("taskAdd");
  const resultAdd=document.getElementById("resultAdd");
  const checkBtnAdd=document.getElementById("checkBtnAdd");
  const newBtnAdd=document.getElementById("newBtnAdd");
  const scoreAdd=document.getElementById("scoreAdd");
  const answerAdd=document.getElementById("answerAdd");
  makeSupButtons("supBtns2", answerAdd);

  let correctAdd="",pointsAdd=0,roundAdd=1,totalAdd=10;

  // Formatierung: Zahl * 10^n ‚Üí mit Komma
  function formatSci(num,exp){
    return `${num.toString().replace('.',',')} ¬∑ 10${superExp[Math.abs(exp)]}${exp<0?'‚Åª':''}`;
  }

  // Zuf√§llige Aufgabe: entweder Zahl ‚Üî Zehnerpotenz
  function createConversionTask(){
    const dir=Math.random()<0.5?"toSci":"toNum"; // Richtung
    const exp = randInt(-5,6); // von -5 bis 6
    const mantissa=(Math.random()*9+1).toFixed(2);
    const value = Number((mantissa*Math.pow(10,exp)).toFixed(6));

    let aufgabe,l√∂sung;

    if(dir==="toSci"){
      // nat√ºrliche Zahl ‚Üí Zehnerpotenz
      aufgabe = value.toLocaleString("de-DE").replace(".",",");
      l√∂sung  = formatSci(mantissa,exp);
    } else {
      // Zehnerpotenz ‚Üí Zahl
      aufgabe = formatSci(mantissa,exp);
      l√∂sung  = value.toLocaleString("de-DE").replace(".",",");
    }

    correctAdd = l√∂sung;
    return aufgabe;
  }

  function newAdditionTask(){
    resultAdd.innerText="";answerAdd.value="";
    if(roundAdd>totalAdd){
      taskAdd.innerText="üéâ √úbungsrunde fertig!";
      resultAdd.style.color="green";
      resultAdd.innerText=`Endstand: ${pointsAdd}/${totalAdd} Punkte.`;
      newBtnAdd.textContent="Neue Runde"; roundAdd=1; pointsAdd=0; return;
    }
    const aufgabe = createConversionTask();
    taskAdd.innerText=aufgabe;
    scoreAdd.innerText=`Aufgabe ${roundAdd} von ${totalAdd} ‚Äì Punkte: ${pointsAdd}`;
  }

  function normalizeNum(s){ return s.replace(/\s/g,"").replace(",","."); }

  function checkAdditionAnswer(){
    const input=answerAdd.value.trim();
    if(!input){resultAdd.style.color="gray";resultAdd.innerText="Bitte gib eine L√∂sung ein.";return;}
    if(normExp(normalizeNum(input))===normExp(normalizeNum(correctAdd))){
      resultAdd.style.color="green";resultAdd.innerText="‚úÖ Richtig!";pointsAdd++;
    } else {
      resultAdd.style.color="red";resultAdd.innerText=`‚ùå Falsch! Richtig: ${correctAdd}`;
    }
    roundAdd++;
    scoreAdd.innerText=`Aufgabe ${Math.min(roundAdd,totalAdd)} von ${totalAdd} ‚Äì Punkte: ${pointsAdd}`;
  }

  checkBtnAdd.addEventListener("click",checkAdditionAnswer);
  newBtnAdd.addEventListener("click",newAdditionTask);
  answerAdd.addEventListener("keydown",e=>{if(e.key==="Enter")checkAdditionAnswer();});
  newAdditionTask();


});
</script>

</body>
</html>
